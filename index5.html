SELECT
pt.cid,
pt.passport_no AS 'passport',
Date_Format( pt.birthday, '%Y/%m/%d' ) AS 'birth',(
CASE
			
WHEN pt.pname LIKE '%ด.ช.%' THEN
'1' 
WHEN pt.pname LIKE '%ด.ญ.%' THEN
'2' 
WHEN pt.pname LIKE '%นาย%' THEN
'3' 
WHEN pt.pname LIKE '%น.ส.%' THEN
'4' 
WHEN pt.pname LIKE '%นางสาว%' THEN
'4' 
WHEN pt.pname LIKE '%นาง%' THEN
'5' ELSE '999' 
END 
) AS 'pre_name',
pt.fname name,
pt.lname,
pt.mobile_phone_number telephone,
pe.eng_fname AS 'name_eng',
pe.eng_lname AS 'lname_eng',

Concat( pt.addrpart, ' ', ' หมู่ที่ ', pt.moopart ) AS 'address',
' ' AS 'address_eng',
n.nhso_code AS 'nation',
pt.chwpart AS 'province',
Concat( pt.chwpart, '', pt.amppart ) AS 'distinct',
Concat( pt.chwpart, '', pt.amppart, '', pt.tmbpart ) AS 'sub_distinct',
'6' AS 'objective',
'7' AS 'scpeciment_type',
pt.hn,
lh.lab_order_number AS 'lab_no',
concat(lh.receive_date," ",lh.receive_time) results_date,
concat(lh.report_date," ",lh.report_time) collection_date,
IF
(
lo.lab_order_result LIKE "%negative%",
"6",
IF
( lo.lab_order_result LIKE "%positive%", "7", "" )) results,
' ' AS 'remark' 
FROM
vn_stat ov
INNER JOIN ovst ON ovst.vn = ov.vn
LEFT OUTER JOIN ovstist sti ON sti.ovstist = ovst.ovstist
LEFT OUTER JOIN opdscreen o ON o.vn = ov.vn
INNER JOIN patient pt ON ov.hn = pt.hn
LEFT OUTER JOIN patient_eng pe ON pt.hn = pe.hn
INNER JOIN thaiaddress t ON t.addressid = Concat( pt.chwpart, pt.amppart, pt.tmbpart )
INNER JOIN nationality n ON n.nationality = pt.nationality
INNER JOIN occupation oc ON oc.occupation = pt.occupation
LEFT OUTER JOIN sex s ON s.CODE = ov.sex
LEFT OUTER JOIN lab_head lh ON lh.vn = ov.vn
LEFT OUTER JOIN lab_order lo ON lo.lab_order_number = lh.lab_order_number
LEFT OUTER JOIN lab_items li ON li.lab_items_code = lo.lab_items_code 
WHERE
ov.vstdate BETWEEN '2021-10-01' 
AND CurDate() 
AND lo.lab_items_code = '3707'